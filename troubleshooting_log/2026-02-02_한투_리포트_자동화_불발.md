# 한국투자증권 리서치 리포트 자동화 불발 기록

**일자**: 2026년 2월 2일
**상태**: 불발 (보안 정책으로 인한 차단)

---

## 목표

한국투자증권 리서치 페이지(https://securities.koreainvestment.com/main/research/research/Strategy.jsp?jkGubun=6)에서 일일 리포트를 자동으로 크롤링하여 AI 요약까지 수행하는 파이프라인 구축

### 계획했던 파이프라인

```
1. [크롤링] 리서치 페이지 접속 → 리포트 목록 파싱 → PDF 다운로드
        ↓
2. [추출] PDF → 텍스트 변환 (PyMuPDF)
        ↓
3. [요약] Claude API로 종합 분석 → Markdown 리포트 생성
```

---

## 문제점

### 1. 안랩(AhnLab) 보안 솔루션 차단

| 항목 | 상태 |
|------|------|
| Selenium WebDriver 접근 | ❌ 차단 |
| WebFetch (HTTP 요청) | ❌ 차단 |
| 개발자 도구 스크래핑 | ❌ 차단 |

- 한투 웹사이트에 안랩 보안 솔루션이 적용되어 있음
- 자동화 도구(봇)를 감지하고 접근을 차단
- 일반 브라우저 접속은 정상 동작하나 프로그래밍적 접근 불가

### 2. 동적 페이지 구조

- JavaScript로 동적 렌더링되는 콘텐츠
- 단순 HTTP 요청으로는 실제 리포트 목록 획득 불가
- Selenium으로 JavaScript 실행 후에도 보안 차단에 걸림

### 3. KIS Developers API 미지원

- KIS Developers API는 **매매 기능 중심**으로만 제공
- 리서치/리포트/애널리스트 보고서 관련 API 없음

---

## 시도한 방법

### 방법 1: Selenium + Chrome WebDriver
```python
# report_crawler.py
- Chrome WebDriver로 페이지 접속
- 테이블에서 리포트 목록 파싱 시도
- 결과: "시스템사정으로 잠시 조회가 불가능합니다" 에러
```

### 방법 2: WebFetch (HTTP 요청)
```
- 직접 URL로 페이지 내용 요청
- 결과: 동일하게 에러 페이지 반환
```

### 방법 3: 다른 URL 시도
```
- www.truefriend.com 도메인 시도
- 결과: 동일하게 차단
```

---

## 에러 로그

```
2026-02-02 23:52:29 - ERROR - 리포트 목록 파싱 오류: Message: stale element reference
2026-02-03 00:00:46 - WARNING - 페이지 로딩 타임아웃
```

---

## 대안 (수동 워크플로우)

자동화가 불가능하므로 다음과 같은 수동 워크플로우 권장:

1. **직접 브라우저 접속**: 한투 웹사이트에서 리포트 PDF 수동 다운로드
2. **eFriend Plus HTS**: HTS 내 리서치 탭에서 리포트 확인
3. **이메일 구독**: 한투 리서치 이메일 구독 후 수신된 리포트 활용
4. **Claude에게 요약 요청**: 다운로드한 PDF를 Claude에게 직접 전달하여 요약

---

## 결론

- 한투 리서치 페이지의 보안 정책으로 인해 **자동 크롤링 불가**
- 향후 KIS Developers API에서 리서치 관련 기능이 추가되면 재시도 가능
- 현재로서는 **수동 다운로드 + AI 요약** 방식이 유일한 대안

---

## 삭제된 파일

이번 시도에서 생성했다가 삭제한 파일들:

```
scripts/
├── main.py
├── report_crawler.py
├── pdf_extractor.py
└── report_summarizer.py

data/
├── raw/
└── extracted/

notes/auto_reports/
results/daily_reports/
logs/

requirements.txt
.env.example
```

---

*기록 작성: 2026년 2월 2일*
